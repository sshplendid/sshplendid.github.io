---
layout: post
title: '지금까지의 일을 정리해보는 것도 좋겠다.'
date: 2022-12-22 11:28:00
categories: [blog, life, log]
img: 'https://images.unsplash.com/photo-1629839958207-5400ab5e1e7f?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=3270&q=80'
img-link: 'https://unsplash.com/photos/HyczMwZbdLg'
img-description: '@claybanks unsplash'
tags: [회고]
---

2020년 이후론 이 블로그에 글을 쓸 일이 없었다.
이 블로그는 내가 어떤 일을 하는지, 뭘 할 수 있는지 남들에게 보여주려고 만들었다.
(구직 활동에 도움이 되었으면 했다.)
하지만 지금의 회사에 입사하고 나서 내가 뭘 하는지 딱히 보여줄 필요가 없어졌다.
필요하다면 회사 내에 내가 하는 일을 글로 정리해서 공유하는게 더 나았다.
(물론 외부에도 올릴 수 있지만 굳이 올리진 않았다.)
아마 지금 회사에 만족하고 있어서 그런 것 같다.

그런데 지금 글을 쓰는 이유는 여태까지의 일을 기록해두는 것도 좋을 것 같아서이다.

## 2021년

### 신규 플랫폼 구축

팀이 두 팀으로 나눠지고 나서 기존에 운영하던 서비스를 나눠야 했다.
데이터베이스부터 소스 코드까지 모두 나눠야 했는데 이 일을 많이 했던 것 같다.
우리 팀은 쇼핑 서비스의 전시를 담당하고 있는데, 상품 데이터를 타 팀에서 받아서 기존처럼 잘 전시하기 위한 신규 코드를 작성했다.
기존에 사용하던 레거시 시스템이 있고, 이걸 신규 프로젝트에서 재작성 해야했다.
히스토리를 잘 몰라서 여기저기 코드와 이슈문서를 뒤적거리면서 작업했다.
잘 달리고 있는 마차의 바퀴를 바꿔야 하는 상황이라 부담감이 컸다.
괜히 바퀴에 손댔다가 마차가 멈출수도 있으니까...

테스트를 충분히 했다고 생각했는데 막상 배포하니 청바지가 나와야 할 상품 카드에 면 100%라고 써있는 택이 나와서 4시간 동안 상품을 재처리해야 하기도 했다.
몇 시간동안 문제가 있었지만 다행히 모든 이슈를 해결하고 일을 완료했다.
(이 때 테스트에 대한 아쉬움이 좀 있었다.)

### Kafka Connect 도입

타 팀에서 Kafka Connect에 대한 도입 사례를 발표했다.
설명을 듣고 데모를 관람하고 나니 우리 팀에서도 적용해볼 여지가 있어보였다.
우리 팀은 MongoDB를 사용하고, 특정 컬렉션의 데이터는 변경내역을 모두 저장하고 있다.

기존에는 Change streams listener를 사용해서 컬렉션마다 핸들러를 작성해주고 있었다.
그런데 kafka connect를 사용하면 커넥터 설정만 해줘도 우리가 코드를 작성해 했던 일을 이 녀석이 알아서 해주는게 아닌가?
그래서 리더에게 이걸 도입하는 작업을 내가 하고싶다고 말했다.

리더는 우리 팀에 도움이 될 것 같다고, 진행해보라고 지지해줬고 한 달동안 열심히 공부하고 poc 수준의 환경을 만들어서 팀에 공유했다.
물론 어려움이 없진 않았다.

kafka connect, 그러니까 CDC(Change Data Capture)는 데이터의 변경 전, 후 값이 있어야 좀 더 의미가 있는데 MongoDB 특성상 이전 데이터는 남지 않는다.
그리고 json 데이터를 표현하는데 어려움이 있어 SMT 라이브러리를 직접 만들어줘야 했다.

어쨌든 우리 팀에 도입해서 코드를 작성하는 일을 많이 줄일 수 있었다.
그리고 지금은 단순 이력관리 데이터 수집을 넘어서 비즈니스에서도 사용하는 수준으로 많이 사용 중이다.